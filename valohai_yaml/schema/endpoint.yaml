type: object
required:
  - name
  - image
additionalProperties: false
properties:
  name:
    type: string
    description: Name of the endpoint, which is used as part of
      the URL (i.e. /project/version/name) of the deployed endpoint.
      Endpoint names must be lowercase, start with a letter and may contain letters,
      numbers and dashes thereafter.
    pattern: "^[a-z][a-z0-9-]+$"
  description:
    type: string
  image:
    type: string
    description: Docker image used to run the deployment code in.
  files:
    type: array
    items:
      "$ref": "./file-item.json"
    description: Files that will be loaded into the image, for example the trained model.
  port:
    type: number
    minimum: 1025
    maximum: 65535
    description: Port used for the HTTP server. Defaults to 8000.
  server-command:
    oneOf:
      - type: string
      - type: array
        items:
          type: string
    description: Command that runs a HTTP server.
  wsgi:
    type: string
    description:
      Specifies the WSGI application to serve (e.g. a Flask application).
      Specify the module (i.e. `package.app`) or
      the module and the WSGI callable (i.e. `package.app:wsgi_callable`).
  node-selector:
    type: string
    description: Kubernetes node selector specifies which nodes the deployment should be scheduled to.
    pattern: "="
  resources:
    type: object
    description: Resource requirements and limits for the endpoint.
    additionalProperties: false
    properties:
      cpu:
        type: object
        description: CPU resource requirements and limits in vCPU counts e.g. 0.1 is 10% of one CPU.
        additionalProperties: false
        properties:
          min:
            type: number
          max:
            type: number
      memory:
        type: object
        description: Memory requirements and limits in MB e.g. 100 is 100 MB.
        additionalProperties: false
        properties:
          min:
            type: number
          max:
            type: number
      devices:
        type: object
        description: "Devices required e.g. 'nvidia.com/gpu: 1' for one NVIDIA GPU."
        patternProperties:
          "^.+$":
            type: number
            minimum: 1
oneOf:
  - required:
      - server-command
  - required:
      - wsgi
